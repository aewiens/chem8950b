##  closed-shell h2o (just to be sure it works)

import sys
sys.path.append('../')

molecule h2o {
0 1
O
H 1 R 
H 1 R 2 A 

R = 1.0 
A = 104.5
}

set {
    reference uhf
    basis cc-pvdz
    scf_type pk
    e_convergence 12
	MAXITER 75
    }

Eref = energy('scf')

basisname = psi4.get_global_option("BASIS")
basisset = psi4.BasisSet.pyconstruct_orbital(h2o,"BASIS",basisname)
mints    = psi4.MintsHelper(basisset)

# call Hartree-Fock code here
from uhf import UHF
uhf = UHF(h2o, mints)
uhf.compute_energy()

print("Psi4 UHF energy:{:21.11f}".format(Eref))
